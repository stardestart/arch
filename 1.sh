sudo ip link set lo down
sudo brctl addbr br0
sudo brctl addif br0 enp0s3
sudo brctl addif br0 br-77cf37c99627
sudo ip link set br0 up
#
#sudo iptables -A FORWARD -i br-4d9b06be0aee -o enp0s3 -j ACCEPT
#sudo iptables -A FORWARD -i enp0s3 -o br-4d9b06be0aee -j ACCEPT
#sudo iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o enp0s3 -j MASQUERADE
#sudo sysctl -w net.ipv4.ip_forward=1
#
#sudo ip route add 192.168.0.0/24 via 192.168.1.254 dev br-4d9b06be0aee
#sudo ip route add 192.168.1.0/24 via 192.168.0.1 dev enp0s3
В Linux можно объединить две сети в мост и подключить одну сеть к выходу в интернет, который есть у второй сети, используя следующие шаги:

    Установка пакета bridge-utils: Для работы с мостами в Linux необходимо установить пакет bridge-utils. Это можно сделать с помощью команды:

bash

sudo apt-get install bridge-utils

    Создание моста: Создайте мост с помощью команды:

bash

sudo brctl addbr br0

Это создаст новый мост с именем br0. 3. Добавление интерфейсов к мосту: Добавьте интерфейсы, которые вы хотите объединить в мост, с помощью команды:

bash

sudo brctl addif br0 eth0

sudo brctl addif br0 eth1

Это добавит интерфейсы eth0 и eth1 к мосту br0. 4. Настройка моста: Настройте мост, чтобы он мог маршрутизировать пакеты между интерфейсами. Для этого необходимо включить опцию net.ipv4.ip_forward в файле /etc/sysctl.conf:

bash

sudo echo "net.ipv4.ip_forward = 1" >> /etc/sysctl.conf

Затем перезагрузите конфигурацию с помощью команды:

bash

sudo sysctl -p /etc/sysctl.conf

    Настройка маршрутизации: Настройте маршрутизацию, чтобы пакеты из одной сети могли попасть в другую сеть. Для этого необходимо добавить маршрут в таблицу маршрутизации:

bash

sudo ip route add 192.168.1.0/24 via 192.168.1.1 dev br0

Это добавит маршрут для сети 192.168.1.0/24 через интерфейс br0 с IP-адресом 192.168.1.1. 6. Подключение одной сети к выходу в интернет: Подключите одну сеть к выходу в интернет, который есть у второй сети. Для этого необходимо настроить NAT (Network Address Translation) на мосте:

bash

sudo iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

Это настроит NAT на мосте, чтобы пакеты из одной сети могли попасть в интернет через другую сеть.

После выполнения этих шагов у вас должна быть настроена мостовая сеть, которая объединяет две сети и позволяет одной сети подключаться к выходу в интернет, который есть у другой сети.

Пример конфигурации:

    Сеть 1: 192.168.1.0/24 (интерфейс eth0)
    Сеть 2: 192.168.2.0/24 (интерфейс eth1)
    Мост: br0 (объединяет интерфейсы eth0 и eth1)
    Маршрут: 192.168.1.0/24 via 192.168.1.1 dev br0
    NAT: iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE

Примечание: В этом примере мы предполагаем, что интерфейс eth0 подключен к сети 192.168.1.0/24, а интерфейс eth1 подключен к сети 192.168.2.0/24. Мост br0 объединяет эти два интерфейса, а маршрут и NAT настроены для того, чтобы пакеты из сети 192.168.2.0/24 могли попасть в интернет через сеть 192.168.1.0/24.
